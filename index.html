<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lakshya</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      line-height: 1.6;
      background: #fefefe;
      color: #222;
    }

    header {
      text-align: center;
      padding: 2rem;
      background: linear-gradient(135deg, #ff7b00, #0056b3);
      color: white;
    }

    header h1 {
      margin: 0;
      font-size: 2.8rem;
    }

    header p {
      margin: 0.5rem 0;
      font-size: 1.2rem;
    }

    .cta-button {
      display: inline-block;
      margin-top: 1rem;
      padding: 0.75rem 1.5rem;
      background: #ff7b00;
      color: #fff;
      text-decoration: none;
      border-radius: 5px;
      font-weight: bold;
      transition: 0.3s;
    }
    .cta-button:hover {
      background: #0056b3;
    }

    nav {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      background: #0056b3;
      padding: 0.75rem 0;
    }

    nav a {
      color: white;
      text-decoration: none;
      font-weight: bold;
    }

    nav a:hover {
      color: #ff7b00;
    }

    section {
      padding: 2rem;
      max-width: 900px;
      margin: auto;
    }

    section h2 {
      color: #0056b3;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    section h2 i {
      color: #ff7b00;
    }

    ul {
      list-style: none;
      padding: 0;
    }

    ul li {
      margin: 0.8rem 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    ul li i {
      color: #ff7b00;
      font-size: 1.2rem;
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      background: #f4faff;
      padding: 2rem;
      border-radius: 8px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    }

    form label {
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
      color: #0056b3;
    }

    form input, form select, form textarea {
      padding: 0.6rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 100%;
    }

    footer {
      text-align: center;
      padding: 1.5rem;
      background: #0056b3;
      color: white;
      margin-top: 2rem;
    }

    footer a {
      color: #ff7b00;
      margin: 0 10px;
      text-decoration: none;
      font-size: 1.2rem;
    }

    #backToTop {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 10px 15px;
      border: none;
      background: #ff7b00;
      color: #fff;
      font-size: 18px;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 3px 6px rgba(0,0,0,0.3);
    }
    
    .metrics-grid {
      display: flex;
      flex-direction: column;
      gap: 2rem;
      justify-items: center;
      margin-top: 1rem;
    }

    .metric-card {
      flex: 1;
      min-width: 250px;
      background: #f4faff;
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      text-align: center;
      position: relative; /* Added for loader */
    }

    .metric-card i {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .metric-card h3 {
      margin: 0.5rem 0;
      font-size: 1.2rem;
    }

    .metric-card p {
      font-size: 1.8rem;
      font-weight: bold;
      margin: 0;
    }
    
    /* Loader styles */
    .loader-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(244, 250, 255, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 10px;
        transition: opacity 0.5s ease-in-out;
        opacity: 0;
        pointer-events: none;
    }
    .loading .loader-overlay {
        opacity: 1;
        pointer-events: auto;
    }

    .karma-spinner {
      width: 50px;
      height: 50px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #ff7b00;
      border-bottom: 4px solid #0056b3;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    .impact-bar-container {
      width: 80%;
      height: 10px;
      background-color: #e0e0e0;
      border-radius: 5px;
      margin-top: 10px;
      overflow: hidden;
    }
    .impact-bar {
      height: 100%;
      background: linear-gradient(90deg, #ff7b00, #0056b3);
      width: 0; /* Will be animated */
      transition: width 0.5s ease-in-out;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Leaderboard styles */
    .leaderboard-container {
        margin-top: 2rem;
        background: #f4faff;
        padding: 2rem;
        border-radius: 8px;
        box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    }
    .leaderboard-container h2 {
        margin-bottom: 1.5rem;
    }
    .leaderboard-list {
        list-style: none;
        padding: 0;
    }
    .leaderboard-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        border-bottom: 1px solid #e0e0e0;
    }
    .leaderboard-item:last-child {
        border-bottom: none;
    }
    .leaderboard-item-rank {
        font-weight: bold;
        color: #ff7b00;
        font-size: 1.2rem;
        width: 30px;
        text-align: center;
    }
    .leaderboard-item-name {
        flex-grow: 1;
        font-weight: bold;
        margin-left: 10px;
    }
    .leaderboard-item-points {
        color: #0056b3;
        font-weight: bold;
    }
    
    /* Skeleton loader styles */
    .skeleton-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        border-bottom: 1px solid #e0e0e0;
        background-color: #e9e9e9;
        border-radius: 5px;
        margin-bottom: 10px;
        animation: pulse 1.5s infinite ease-in-out;
    }
    .skeleton-item-text {
        height: 15px;
        background-color: #c9c9c9;
        border-radius: 4px;
    }
    .skeleton-rank {
        width: 25px;
    }
    .skeleton-name {
        width: 40%;
        margin-left: 10px;
    }
    .skeleton-points {
        width: 20%;
    }

    @keyframes pulse {
        0% { opacity: 0.6; }
        50% { opacity: 1; }
        100% { opacity: 0.6; }
    }

  </style>
</head>
<body>

  <header>
    <h1><i class="fas fa-handshake"></i> Lakshya</h1>
    <p>Gamified Civic Engagement Platform Powered by Microsoft Azure</p>
    <a href="#pledge" class="cta-button">Join the Movement</a>
  </header>

  <nav>
    <a href="#about">About</a>
    <a href="#why">Why</a>
    <a href="#features">Features</a>
    <a href="#impact">Impact</a>
    <a href="#azure">Azure AI</a>
    <a href="#dashboard">Sponsors</a>
    <a href="#pledge">Pledge</a>
    <a href="#contact">Contact</a>
  </nav>

  <section id="about">
    <h2><i class="fas fa-info-circle"></i> About Lakshya</h2>
    <p>Lakshya is a civic-tech platform that transforms personal goals into national impact. Whether you're walking for health or learning new skills, your actions earn Karma Points that fund public-good initiatives like health camps and scholarships.</p>
  </section>

  <section id="why">
    <h2><i class="fas fa-question-circle"></i> Why Lakshya?</h2>
    <ul>
      <li><i class="fas fa-flag"></i> Your pledge. Our progress.</li>
      <li><i class="fas fa-users"></i> Make a Lakshya. Move a nation.</li>
      <li><i class="fas fa-gem"></i> Resolve meets reward.</li>
      <li><i class="fas fa-globe"></i> Built for Bharat. Built for the future.</li>
    </ul>
  </section>

  <section id="features">
    <h2><i class="fas fa-star"></i> Platform Features</h2>
    <ul>
      <li><i class="fas fa-bullseye"></i> Personal Lakshyas aligned with national missions</li>
      <li><i class="fas fa-gamepad"></i> Gamified progress tracking</li>
      <li><i class="fas fa-heart"></i> Karma Points for verified actions</li>
      <li><i class="fas fa-hand-holding-heart"></i> Public-good rewards funded by sponsors</li>
      <li><i class="fas fa-chart-line"></i> Real-time dashboards for sponsors and government</li>
      <li><i class="fas fa-mobile-alt"></i> Mobile-friendly experience with push notifications</li>
    </ul>
  </section>

  <section id="impact">
    <h2><i class="fas fa-bolt"></i> Impact So Far</h2>
    <ul>
      <li><i class="fas fa-coins"></i> Karma Points Earned</li>
      <li><i class="fas fa-clinic-medical"></i> Health Camps Sponsored</li>
      <li><i class="fas fa-graduation-cap"></i> Scholarships Funded</li>
      <li><i class="fas fa-users"></i> Active Users Engaged</li>
    </ul>
  </section>

  <section id="azure">
    <h2><i class="fas fa-cloud"></i> Powered by Microsoft Azure</h2>
    <ul>
      <li><i class="fas fa-database"></i> Cosmos DB: Stores Lakshyas and Karma Points</li>
      <li><i class="fas fa-robot"></i> Machine Learning: Analyzes engagement trends</li>
      <li><i class="fas fa-sync-alt"></i> Logic Apps: Automates reward conversion</li>
      <li><i class="fas fa-bell"></i> Notification Hubs: Sends real-time updates</li>
      <li><i class="fas fa-comments"></i> Communication Services: Adds in-app chat and SMS</li>
      <li><i class="fas fa-shield-alt"></i> Azure AD B2C: Secure</li>
    </ul>
  </section>

<section id="liveMetrics">
  <h2><i class="fas fa-tachometer-alt"></i> Live Impact Metrics</h2>
  <div class="metrics-grid">
    <div class="metric-card" id="karmaPointsCard">
      <div class="loader-overlay">
          <div class="karma-spinner"></div>
      </div>
      <i class="fas fa-coins" style="color: #ff7b00;"></i>
      <h3>Karma Points Earned</h3>
      <p id="karmaPoints">Loading...</p>
    </div>
    <div class="metric-card" id="activeUsersCard">
      <div class="loader-overlay">
          <div class="impact-bar-container">
              <div class="impact-bar" id="impactBar"></div>
          </div>
      </div>
      <i class="fas fa-users" style="color: #0056b3;"></i>
      <h3>Active Citizens</h3>
      <p id="activeUsers">Loading...</p>
    </div>
    <div class="metric-card" id="rewardsUnlockedCard">
        <div class="loader-overlay">
            <div class="karma-spinner"></div>
        </div>
      <i class="fas fa-gift" style="color: #28a745;"></i>
      <h3>Rewards Unlocked</h3>
      <p id="rewardsUnlocked">Loading...</p>
    </div>
  </div>
</section>

<section id="leaderboard" class="leaderboard-container">
    <h2><i class="fas fa-trophy"></i> Top Karma Earners</h2>
    <ul class="leaderboard-list" id="leaderboardList">
      <li class="skeleton-item"><div class="skeleton-item-text skeleton-rank"></div><div class="skeleton-item-text skeleton-name"></div><div class="skeleton-item-text skeleton-points"></div></li>
      <li class="skeleton-item"><div class="skeleton-item-text skeleton-rank"></div><div class="skeleton-item-text skeleton-name"></div><div class="skeleton-item-text skeleton-points"></div></li>
      <li class="skeleton-item"><div class="skeleton-item-text skeleton-rank"></div><div class="skeleton-item-text skeleton-name"></div><div class="skeleton-item-text skeleton-points"></div></li>
      <li class="skeleton-item"><div class="skeleton-item-text skeleton-rank"></div><div class="skeleton-item-text skeleton-name"></div><div class="skeleton-item-text skeleton-points"></div></li>
      <li class="skeleton-item"><div class="skeleton-item-text skeleton-rank"></div><div class="skeleton-item-text skeleton-name"></div><div class="skeleton-item-text skeleton-points"></div></li>
    </ul>
</section>

<section id="pledge">
  <h2><i class="fas fa-pen-fancy"></i> Make Your Lakshya</h2>
  <form id="pledgeForm">
    <label for="mission"><i class="fas fa-bullseye"></i> Choose a Mission:</label>
    <select id="mission" required>
      <option value="">-- Select --</option>
      <option>Healthcare for All</option>
      <option>Education & Skilling</option>
      <option>Sustainability</option>
    </select>

    <label for="goal"><i class="fas fa-shoe-prints"></i> Your Goal:</label>
    <input type="text" id="goal" required minlength="5" placeholder="e.g., Walk 10,000 steps daily"/>

    <label for="reason"><i class="fas fa-comment-dots"></i> Why does this matter to you?</label>
    <textarea id="reason" rows="4" required placeholder="Share your motivation..."></textarea>

    <button type="submit" class="cta-button"><i class="fas fa-paper-plane"></i> Submit My Lakshya</button>
  </form>
</section>

<section id="contact">
  <h2><i class="fas fa-address-book"></i> Contact Us</h2>
  <p><i class="fas fa-envelope"></i> Email: <a href="mailto:support@lakshya.in">support@lakshya.in</a></p>
  <p><i class="fab fa-linkedin"></i> LinkedIn: <a href="#">linkedin.com/company/lakshya</a></p>
  <p><i class="fab fa-twitter"></i> Twitter: <a href="#">@LakshyaIndia</a></p>
  <p><i class="fab fa-instagram"></i> Instagram: <a href="#">@lakshya_platform</a></p>
</section>

<footer>
  <p>© 2025 Lakshya Platform. All rights reserved.</p>
  <div>
    <a href="#"><i class="fab fa-facebook"></i></a>
    <a href="#"><i class="fab fa-twitter"></i></a>
    <a href="#"><i class="fab fa-instagram"></i></a>
    <a href="#"><i class="fab fa-linkedin"></i></a>
  </div>
  <p>Empowering citizens. Enabling change.</p>
</footer>

<button id="backToTop" title="Back to top">↑</button>

<script>
  // Azure Function URL placeholders. Replace with your actual URLs.
  const METRICS_API_URL = 'YOUR_AZURE_FUNCTION_URL_FOR_METRICS';
  const LEADERBOARD_API_URL = 'YOUR_AZURE_FUNCTION_URL_FOR_LEADERBOARD';
  const PLEDGE_API_URL = 'YOUR_AZURE_FUNCTION_URL_FOR_PLEDGE_SUBMISSION';

  document.getElementById('backToTop').addEventListener('click', function () {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  // Handle form submission to Azure Function
  document.getElementById('pledgeForm').addEventListener('submit', async function (e) {
    e.preventDefault();
    const form = e.target;
    const formData = {
      mission: form.mission.value,
      goal: form.goal.value,
      reason: form.reason.value,
    };
    
    // Disable button and show a loading state if needed
    const submitButton = form.querySelector('button');
    const originalButtonText = submitButton.innerHTML;
    submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
    submitButton.disabled = true;

    try {
      const response = await fetch(PLEDGE_API_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(formData),
      });

      if (response.ok) {
        alert('Thank you for your Lakshya! Your pledge has been submitted successfully.');
        form.reset();
      } else {
        alert('An error occurred. Please try again later.');
        console.error('Submission failed:', response.statusText);
      }
    } catch (error) {
      alert('Network error. Please check your connection and try again.');
      console.error('Submission failed:', error);
    } finally {
      // Re-enable button
      submitButton.innerHTML = originalButtonText;
      submitButton.disabled = false;
    }
  });

  // Function to fetch and update live metrics
  async function updateMetrics() {
    const metricsCards = [
      document.getElementById('karmaPointsCard'),
      document.getElementById('activeUsersCard'),
      document.getElementById('rewardsUnlockedCard')
    ];
    
    // Start loading animations
    metricsCards.forEach(card => card.classList.add('loading'));

    try {
      // Replace this with a call to your Azure Function endpoint
      const response = await fetch(METRICS_API_URL);
      if (!response.ok) {
        throw new Error('Failed to fetch metrics');
      }
      const data = await response.json();
      
      const karmaPoints = data.karmaPoints || 0;
      const activeUsers = data.activeUsers || 0;
      const rewardsUnlocked = data.rewardsUnlocked || 0;
      
      document.getElementById('karmaPoints').textContent = karmaPoints.toLocaleString();
      document.getElementById('activeUsers').textContent = activeUsers.toLocaleString();
      document.getElementById('rewardsUnlocked').textContent = rewardsUnlocked.toLocaleString();

      // Animate impact bar
      const maxUsers = 10000; // Define a max value for the progress bar
      const percentage = (activeUsers / maxUsers) * 100;
      document.getElementById('impactBar').style.width = ${Math.min(percentage, 100)}%;

    } catch (error) {
      console.error("Error fetching metrics:", error);
      // Fallback to static or placeholder data on error
      document.getElementById('karmaPoints').textContent = 'N/A';
      document.getElementById('activeUsers').textContent = 'N/A';
      document.getElementById('rewardsUnlocked').textContent = 'N/A';
    } finally {
      // Stop loading animations
      metricsCards.forEach(card => card.classList.remove('loading'));
    }
  }

  // Function to fetch and update leaderboard
  async function updateLeaderboard() {
      const leaderboardList = document.getElementById('leaderboardList');
      leaderboardList.innerHTML = ''; // Clear skeleton loader
      
      // Add skeleton loader while fetching
      for (let i = 0; i < 5; i++) {
        leaderboardList.innerHTML += <li class="skeleton-item"><div class="skeleton-item-text skeleton-rank"></div><div class="skeleton-item-text skeleton-name"></div><div class="skeleton-item-text skeleton-points"></div></li>;
      }

      try {
        const response = await fetch(LEADERBOARD_API_URL);
        if (!response.ok) {
          throw new Error('Failed to fetch leaderboard');
        }
        const users = await response.json();

        leaderboardList.innerHTML = ''; // Clear skeleton again to show real data
        users.sort((a, b) => b.karmaPoints - a.karmaPoints);

        if (users.length > 0) {
            users.forEach((user, index) => {
              const listItem = document.createElement('li');
              listItem.className = 'leaderboard-item';
              listItem.innerHTML = `
                <div class="leaderboard-item-rank">${index + 1}</div>
                <div class="leaderboard-item-name">${user.name}</div>
                <div class="leaderboard-item-points">${user.karmaPoints.toLocaleString()}</div>
              `;
              leaderboardList.appendChild(listItem);
            });
        } else {
            leaderboardList.innerHTML = '<p style="text-align: center;">No users on the leaderboard yet. Be the first!</p>';
        }

      } catch (error) {
        console.error("Error fetching leaderboard:", error);
        leaderboardList.innerHTML = '<p style="text-align: center; color: red;">Could not load leaderboard. Please try again later.</p>';
      }
  }
  
  // Initial calls and set intervals
  updateMetrics();
  updateLeaderboard();
  setInterval(updateMetrics, 5000);
  setInterval(updateLeaderboard, 30000); // Update leaderboard less frequently
</script>

</body>
</html>
